#!/bin/sh

CFLAGS='-Wall -O2'
INSTDIR=/opt

for i in "$@"; do
  case $i in
    --help | -h)
      echo "  --help, -h       show this help"
      echo "  --instdir=*      change install prefix"
      echo "  --cc=*           set compiler"
      echo "  --cflags=*       set compiler flags\n"
      echo "  [ CFLAGS special attributes ]"
      echo "  -DCL_IMG_DIR=*   static path for game images"
      echo "  -DCL_SND_DIR=*   static path for game sounds"
      exit
      ;;
    --instdir=*)
      INSTDIR="${i#*=}"
      ;;
    --cflags=*)
      CFLAGS="${i#*=}"
      ;;
    --cc=*)
      CC=`which ${i#*=}`
      ;;
    *)
      # unknown option
      ;;
  esac
done

echo ""
if [ -n "$CC" ]; then
  echo "  compiler       : $CC"
else
  echo "  compiler       : cc"
fi
echo "  compiler flags : $CFLAGS"
echo "  install prefix : $INSTDIR"
echo ""

`sed "s#@@CC@@#$CC#" in/Makefile.in | sed "s#@@CFLAGS@@#$CFLAGS#" | sed "s#@@INSTDIR@@#$INSTDIR#" > Makefile`
